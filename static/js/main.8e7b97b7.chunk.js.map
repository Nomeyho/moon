{"version":3,"sources":["phases.js","data.js","utils.js","Moon.js","App.js","index.js"],"names":["phases","name","arcStart","arcEnd","Math","PI","scaleX","invert","getMoonPhase","y","m","d","jd","b","floor","addDay","date","setDate","getDate","getData","year","data","startDate","Date","UTC","endDate","month","getMonth","day","push","phase","range","n","Object","toConsumableArray","Array","keys","months","Moon","r","start","end","arc","outerRadius","innerRadius","startAngle","endAngle","_this$props","this","props","x","size","cx","cy","_phases$phase","react_default","a","createElement","className","transform","concat","stroke","fill","getArc","PureComponent","MARGIN","YEAR","getFullYear","App","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","width","height","container","React","createRef","onResize","bind","assertThisInitialized","renderMoon","window","addEventListener","removeEventListener","current","clientWidth","console","debug","min","setState","datum","src_Moon","key","map","fontSize","_this$state","ref","renderMonths","renderDays","Component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.8e7b97b7.chunk.js","sourcesContent":["// http://bl.ocks.org/bdon/e6405ebabd4f3013c342\n\nconst phases = [\n  {\n    name: 'New Moon',\n    arcStart: 0,\n    arcEnd: 2 * Math.PI,\n    scaleX: 0,\n    invert: false\n  },\n  {\n    name: 'Waxing Crescent',\n    arcStart: Math.PI,\n    arcEnd: 2 * Math.PI,\n    scaleX: 0.7,\n    invert: false\n  },\n  {\n    name: 'First Quarter',\n    arcStart: Math.PI,\n    arcEnd: 2 * Math.PI,\n    scaleX: 0,\n    invert: false\n  },\n  {\n    name: 'Waxing Gibbous',\n    arcStart: 0,\n    arcEnd: Math.PI,\n    scaleX: 0.7,\n    invert: true\n  },\n  {\n    name: 'Full Moon',\n    arcStart: 0,\n    arcEnd: 0,\n    scaleX: 0,\n    invert: false\n  },\n  {\n    name: 'Waning Gibbous',\n    arcStart: Math.PI,\n    arcEnd: 2 * Math.PI,\n    scaleX: 0.7,\n    invert: true\n  },\n  {\n    name: 'Third Quarter',\n    arcStart: 0,\n    arcEnd: Math.PI,\n    scaleX: 0,\n    invert: false\n  },\n  {\n    name: 'Waning Crescent',\n    arcStart: 0,\n    arcEnd: Math.PI,\n    scaleX: 0.7,\n    invert: false\n  }\n]\n\nconst getMoonPhase = (y, m, d) => {\n  if (m < 3) {\n    y--\n    m += 12\n  }\n  m = m + 1\n\n  let c = 365.25 * y\n  let e = 30.6 * m\n  let jd = c + e + d - 694039.09\n  jd = jd / 29.53\n\n  let b = Math.floor(jd)\n  jd -= b\n  b = jd * 8 + 0.5\n  b = b & 7\n\n  return b\n}\n\nexport {\n  phases,\n  getMoonPhase,\n}\n","import { getMoonPhase } from './phases'\n\nconst addDay = date => date.setDate(date.getDate() + 1)\n\nconst getData = (year) => {\n  const data = []\n  const startDate = new Date(Date.UTC(year, 0, 1))\n  const endDate = new Date(Date.UTC(year + 1, 0, 1))\n\n  for (let date = startDate; date < endDate; addDay(date)) {\n    const month = date.getMonth() + 1\n    const day = date.getDate()\n    data.push({\n      month,\n      day,\n      year,\n      phase: getMoonPhase(year, month, day)\n    });\n  }\n\n  return data\n}\n\nexport {\n  getData,\n}\n","\nconst range = (n) => [...Array(n).keys()]\n\nconst months = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec'\n]\n\nexport {\n  range,\n  months,\n}\n","import React, { PureComponent } from 'react'\nimport { arc } from 'd3'\nimport { phases } from './phases'\n\nconst WHITE = '#FFFFFF'\nconst BLACK = '#010141'\n\nclass Moon extends PureComponent {\n\n  getArc(r, start, end) {\n    return arc()\n      .outerRadius(r)\n      .innerRadius(0)\n      .startAngle(start)\n      .endAngle(end)()\n  }\n\n  render() {\n    const { x, y, size, phase } = this.props\n    const cx = size / 2\n    const cy = size / 2\n    const r = size / 3\n    const { name, invert, scaleX, arcStart, arcEnd } = phases[phase]\n\n    if(name === 'New Moon') {\n      return (\n        <g className=\"moon\" transform={`translate(${x},${y})`}>\n          <circle\n            className=\"background\"\n            cx={cx}\n            cy={cy}\n            r={r}\n            stroke={WHITE}\n            fill=\"none\"\n          />\n        </g>\n      )\n    }\n\n    return (\n      <g className=\"moon\" transform={`translate(${x},${y})`}>\n        <circle\n          className=\"background\"\n          cx={cx}\n          cy={cy}\n          r={r}\n          stroke={BLACK}\n          fill={invert ? BLACK : WHITE}\n        />\n        <circle\n          className=\"foreground\"\n          cx={cx * 1.4}\n          cy={cy}\n          r={r}\n          fill={invert ? WHITE : BLACK}\n          transform={`scale(${scaleX}, 1)`}\n        />\n        <path\n          d={this.getArc(r, arcStart, arcEnd)}\n          fill={invert ? WHITE : BLACK}\n          transform={`translate(${cx},${cx})`}\n        />\n      </g>\n    )\n  }\n}\n\nexport default Moon\n","import React, { Component } from 'react'\nimport { getData } from './data'\nimport { range, months } from './utils'\nimport Moon from './Moon'\n\nconst MARGIN = { left: 50, top: 50, right: 0, bottom: 0 }\nconst YEAR = new Date().getFullYear()\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      size: 0,\n      width: 0,\n      height: 0,\n      year: YEAR,\n      data: getData(YEAR)\n    }\n    this.container = React.createRef()\n    this.onResize = this.onResize.bind(this)\n    this.renderMoon = this.renderMoon.bind(this)\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.onResize)\n    this.onResize()\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onResize)\n  }\n\n  onResize() {\n    const container = this.container.current\n\n    if(container) {\n      const { clientWidth } = container\n      console.debug(`Resize ${clientWidth} px`)\n\n      const width = Math.min(clientWidth * 0.7 || 0, 1000)\n      const size = (width - MARGIN.left - MARGIN.right) / 12\n      const height = size * 31 + MARGIN.top + MARGIN.bottom\n\n      this.setState({ size, width, height })\n    }\n  }\n\n  renderMoon(datum) {\n    const { size } = this.state\n    const { month, day, phase } = datum\n\n    return (\n      <Moon\n        key={`${month}-${day}`}\n        size={size}\n        x={MARGIN.left + (month - 1) * size}\n        y={MARGIN.top + (day - 1) * size}\n        phase={phase}\n      />\n    )\n  }\n\n  renderMonths() {\n    const { size } = this.state\n    \n    return range(12).map(m => \n      <text\n        className=\"legend\"\n        key={m}\n        x={MARGIN.left + (m + 0.5) * size}\n        y={MARGIN.top / 2}\n        fontSize={size / 3}\n      >\n        { months[m] }\n      </text>\n    )\n  }\n\n  renderDays() {\n    const { size } = this.state\n\n    return range(31).map(d => \n      <text\n        className=\"legend\"\n        key={d}\n        x={MARGIN.left / 2}\n        y={MARGIN.top + (d + 0.5) * size}\n        fontSize={size / 3}\n      >\n        {d + 1}\n      </text>\n    )\n  }\n\n  render() {\n    const { width, height, year, data } = this.state\n\n    return (\n      <div ref={this.container}>\n        <h1 className=\"title\">\n          Moon\n        </h1>\n        <h2 className=\"subtitle\">\n          {year}\n        </h2>\n        <svg width={width} height={height}>\n          { this.renderMonths() }\n          { this.renderDays() }\n          { data.map(this.renderMoon) }\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport 'normalize.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}